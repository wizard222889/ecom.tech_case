# ecom.tech test_case

Проект представляет собой ETL для расчета аналитического запроса, в частности, для каждого города определяет топ-3 магазина по общей сумме заказов, сделанных пользователями с датой регистрацией в 2025 году

### Стек:
python, minio, pyspark, docker, boto3, faker

### Логика:
Запуск происходит в ```src/main.py```, который проверяет папку ```data``` на наличие файлов ```orders.parquet, stores.parquet, users.parquet ```. Если их нет, запускается скрипт в ```utils/generate_data``` и создаются данные, которые потом выгружаются в MinIO в бакет ```raw-data``` (используется самонаписанный коннектор s3). Дальше запускается ```store_vitrina.py```, который с помощью Spark вычисляет и загружает данные в бакет ```final-data```. Предусмотрена автоматическая выгрузка данных из s3 в папку ```data```.

### Запуск
1. ```docker-compose up --build```
2. Зайти на ```http://localhost:9001``` (MinIO Console)

### Тесты
Запуск: ```pytest tests/```

### Примечание
Первый запуск в docker может быть долгим, поскольку spark приходится скачивать java-файлы, а также он сам достаточно большой по размеру